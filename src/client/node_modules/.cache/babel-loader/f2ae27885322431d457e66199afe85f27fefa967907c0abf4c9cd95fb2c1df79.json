{"ast":null,"code":"import { APIService } from '@/core/util/services/api.service';\nimport { navigate } from '@ohrm/core/util/helper/navigation';\nimport { required, numericOnly, validSelection, shouldNotExceedCharLength, numberShouldBeBetweenMinAndMaxValue } from '@ohrm/core/util/validation/rules';\nimport EmployeeAutocomplete from '@/core/components/inputs/EmployeeAutocomplete';\nimport JobtitleDropdown from '@/orangehrmPimPlugin/components/JobtitleDropdown';\nimport VacancyLinkCard from '../components/VacancyLinkCard.vue';\nimport { OxdSwitchInput } from '@ohrm/oxd';\nimport useServerValidation from '@/core/util/composable/useServerValidation';\nconst vacancyModel = {\n  jobTitle: null,\n  name: '',\n  hiringManager: null,\n  numOfPositions: '',\n  description: '',\n  status: true,\n  isPublished: true\n};\nconst basePath = `${window.location.protocol}//${window.location.host}${window.appGlobal.baseUrl}`;\nexport default {\n  components: {\n    'oxd-switch-input': OxdSwitchInput,\n    'employee-autocomplete': EmployeeAutocomplete,\n    'jobtitle-dropdown': JobtitleDropdown,\n    'vacancy-link-card': VacancyLinkCard\n  },\n  setup() {\n    const http = new APIService(window.appGlobal.baseUrl, '/api/v2/recruitment/vacancies');\n    const {\n      createUniqueValidator\n    } = useServerValidation(http);\n    const vacancyNameUniqueValidation = createUniqueValidator('Vacancy', 'name');\n    return {\n      http,\n      vacancyNameUniqueValidation\n    };\n  },\n  data() {\n    return {\n      isLoading: false,\n      vacancy: {\n        ...vacancyModel\n      },\n      rules: {\n        jobTitle: [required],\n        name: [required, this.vacancyNameUniqueValidation, shouldNotExceedCharLength(50)],\n        hiringManager: [required, validSelection],\n        numOfPositions: [value => {\n          if (value === null || value === '') return true;\n          return typeof numericOnly(value) === 'string' ? numericOnly(value) : numberShouldBeBetweenMinAndMaxValue(1, 99)(value);\n        }],\n        description: [],\n        status: [required],\n        isPublished: [required]\n      },\n      rssFeedUrl: `${basePath}/recruitmentApply/jobs.rss`,\n      webUrl: `${basePath}/recruitmentApply/jobs.html`\n    };\n  },\n  methods: {\n    onCancel() {\n      navigate('/recruitment/viewJobVacancy');\n    },\n    onSave() {\n      this.isLoading = true;\n      this.vacancy = {\n        name: this.vacancy.name,\n        jobTitleId: this.vacancy.jobTitle.id,\n        employeeId: this.vacancy.hiringManager.id,\n        numOfPositions: this.vacancy.numOfPositions ? parseInt(this.vacancy.numOfPositions) : null,\n        description: this.vacancy.description,\n        status: this.vacancy.status,\n        isPublished: this.vacancy.isPublished\n      };\n      this.http.create({\n        ...this.vacancy\n      }).then(response => {\n        const {\n          data\n        } = response.data;\n        this.$toast.saveSuccess();\n        navigate('/recruitment/addJobVacancy/{id}', {\n          id: data.id\n        });\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}